<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOGOOD - Admin</title>
    <style>
        body { background-color: #0a0a0a; color: white; font-family: 'Segoe UI', sans-serif; padding: 20px; }
        .admin-box { max-width: 800px; margin: auto; background: #151515; border-radius: 20px; border: 1px solid #00ff88; overflow: hidden; }
        .admin-nav { background: #00ff88; color: black; padding: 15px 25px; display: flex; justify-content: space-between; align-items: center; }
        .table-area { padding: 20px; overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; text-align: left; }
        th, td { padding: 12px; border-bottom: 1px solid #333; }
        th { color: #00ff88; }
        .btn-del { background: #ff4444; border: none; color: white; padding: 5px 10px; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>

    <div class="admin-box">
        <div class="admin-nav">
            <h2 style="margin:0;">SYSTEM ADMIN</h2>
            <button onclick="logout()" style="background:black; color:white; border:none; padding:8px 15px; border-radius:8px; cursor:pointer;">LOGOUT</button>
        </div>
        <div class="table-area">
            <h3>รายชื่อสมาชิกทั้งหมด</h3>
            <table>
                <thead>
                    <tr>
                        <th>ชื่อเล่น</th>
                        <th>User</th>
                        <th>IP</th>
                        <th>จัดการ</th>
                    </tr>
                </thead>
                <tbody id="userTable"></tbody>
            </table>
        </div>
    </div>

    <script>
        const user = JSON.parse(localStorage.getItem('currentUser'));
        // เช็คสิทธิ์เข้มงวด
        if (!user || user.role !== 'admin') {
            alert("คุณไม่มีสิทธิ์!"); window.location.href = 'index.html';
        }

        function loadData() {
            const list = JSON.parse(localStorage.getItem('usersList')) || [];
            document.getElementById('userTable').innerHTML = list.map((u, i) => `
                <tr>
                    <td>${u.nickname}</td>
                    <td>${u.username}</td>
                    <td style="color:#888;">${u.ip}</td>
                    <td><button class="btn-del" onclick="delUser(${i})">ลบ</button></td>
                </tr>
            `).join('');
        }

        function delUser(i) {
            if(confirm('ลบผู้ใช้นี้?')) {
                let list = JSON.parse(localStorage.getItem('usersList'));
                list.splice(i, 1);
                localStorage.setItem('usersList', JSON.stringify(list));
                loadData();
            }
        }
        function logout() { localStorage.removeItem('currentUser'); window.location.href = 'index.html'; }
        loadData();
    </script>
</body>
</html>
